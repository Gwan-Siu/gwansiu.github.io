<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="在黑暗中前行，在黑暗中摸索，探寻未知的光明">
    <meta name="keywords"  content="GwanSiu, 肖均，计算机视觉，机器学习，读书">
    <meta name="theme-color" content="#000000">
    
    <title>SIFT算子 - 肖均的博客 | GwanSiu Blog</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favi.ico">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="http://localhost:4000/2017/05/27/SIFT/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>

  <script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>

<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">GwanSiu Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                    <li>
                        <a href="/about/">About</a>
                    </li>
                    
                    <li>
                        <a href="/tags/">Tags</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    var __HuxNav__ = {
        close: function(){
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        },
        open: function(){
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }

    // Bind Event
    $toggle.addEventListener('click', function(e){
        if ($navbar.className.indexOf('in') > 0) {
            __HuxNav__.close()
        }else{
            __HuxNav__.open()
        }
    })

    /**
     * Since Fastclick is used to delegate 'touchstart' globally
     * to hack 300ms delay in iOS by performing a fake 'click',
     * Using 'e.stopPropagation' to stop 'touchstart' event from 
     * $toggle/$collapse will break global delegation.
     * 
     * Instead, we use a 'e.target' filter to prevent handler
     * added to document close HuxNav.  
     *
     * Also, we use 'click' instead of 'touchstart' as compromise
     */
    document.addEventListener('click', function(e){
        if(e.target == $toggle) return;
        if(e.target.className == 'icon-bar') return;
        __HuxNav__.close();
    })
</script>


    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/home-bg.jpg" width="0" height="0"> -->

<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/home-bg.jpg')
    }

    
</style>
<header class="intro-header" >
    <div class="header-mask"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/#Machine Learning" title="Machine Learning">Machine Learning</a>
                        
                    </div>
                    <h1>SIFT算子</h1>
                    
                    
                    <h2 class="subheading"></h2>
                    
                    <span class="meta">Posted by GwanSiu on May 27, 2017</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

				<h2 id="1introduction">1.Introduction</h2>
<p>SIFT(Scale Invariant Feature Transform) featuers are invariant to image scaling and ratation, and patially invariant to change in illumination and 3D camera viewpoint. The key point of this approach is to generate lots of numbers of features and densely cover the image over all the location and scale.</p>

<p>The properties of SIFT features:</p>
<ol>
  <li>SIFT features are invariant to image scaling and roration, and patially invariant to change in illumination and 3D camera viewpoint. The featues are also robust to illuminatin, occlusion and affine transform.</li>
  <li>SIFT features are highly distinctive, which allows a single feature to be correctly matched with high probability against a large database of features, providing a basis for object and scene recognition.</li>
  <li>lots of numbers of features can be generaed from few objects.</li>
  <li><strong>Real-Time</strong>: For object recognition, SIFT features can be matched quickly in large database.</li>
  <li>SIFT also have the the ability to detect small objects in cluttered backgrounds requires that at least 3 features be correctly matched from each object for reliable identification.</li>
</ol>

<p>In this blog, we simply summary SIFT featues and its properties. In section 2, the produce of SIFT features caculation is introduced. In section 3, we will analysis SIFT features in depth and try to answer the question: why are SIFT features invariant to image scaling and rotation? why are SIFT featues robust to illumination? In addition, this blog is written in English and Chinese.</p>

<h2 id="2the-process-of-sift-calculation摘抄原文1">2.The Process of SIFT calculation(摘抄原文[1])</h2>
<ol>
  <li><strong>Scale-space extrema detection（尺度空间的极点检测）:</strong>The first stage of computation searches over all scales and image locations. It is implemented efficiently by <em>using a difference-of-Gaussian function to identify potential interest points that are invariant to scale and orientation.</em> （所有图像所有尺度和位置，使用difference-of-Gaussian function检测出具有尺度不变性和方向不变性的interst points）</li>
  <li><strong>Keypoint localization(特征点定位):</strong> At each candidate location, a detailed model is fit to determine location and scale. <em>Keypoints are selected based on measures of their stability.</em> (这一步是在所有的特征点中，选择出具有稳定性的特征点)</li>
  <li><strong>Orientation assignment(赋予方向):</strong> One or more orientations are assigned to each keypoint lo- cation based on local image gradient directions. <strong>All future operations are performed on image data that has been transformed relative to the assigned orientation, scale, and location for each feature, thereby providing invariance to these transformations.</strong></li>
  <li><strong>Keypoint descriptor(特征点描述子):</strong> The local image gradients are measured at the selected scale in the region around each keypoint. These are transformed into a representation that allows for significant levels of local shape distortion and change in illumination.</li>
</ol>

<h3 id="21-scale-space-extrema-detection">2.1 Scale-space extrema detection</h3>

<ol>
  <li>Construct image scale space based on Gaussian function:</li>
</ol>

<script type="math/tex; mode=display">L(x,y,\sigma)=G(x,y,\sigma)*I(x,y)</script>

<p>where, $\text{*}$ is the convolution operation in x and y, and</p>

<script type="math/tex; mode=display">G(x,y,\sigma) = \frac{1}{2\pi \sigma^{2}}e^{-(x^{2}+y^{2})/2\sigma^{2}}</script>

<p>Using scale-space extrema in the difference-of-Guassian function convolved with the image to efficiently detect stable keypoint locations in the scale space.</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
D(x,y,\sigma) &=(G(x,y,k\sigma)-G(x,y,\sigma))* I(x,y) \\  

&= L(x,y,k\sigma)-L(x,y,\sigma)
\end{aligned} %]]></script>

<p><img src="http://static.zybuluo.com/GwanSiu/0hz6rz3rpvdq1a39zsfvu5tm/image_1bh7i445eip13np1j0gv52m1e9.png" alt="image_1bh7i445eip13np1j0gv52m1e9.png-88.1kB" /></p>

<p>One octave represents one resolution of an image. In each octave,
different scale-space of the image are constructed  by the gaussian function. Adjacent Gaussian images are subtracted to produce the difference-of-Gaussian images on the right. After each octave, the Gaussian image is down-sampled by a factor of 2, and the process repeated.</p>

<p><strong>1. 为什么要使用gaussian function 来构造尺度空间？</strong></p>

<p>Koenderink (1984) and Lindeberg (1994)在其论文中表明：Gasussian function 是唯一一个尺度空间核（scale-space kernel), 可以使用Gaussian function来构造图像的尺度空间。</p>

<p><strong>2.为什么使用difference-of-gaussian function作为scale invariant features detector?</strong></p>

<p>Difference-of-Gaussian function approximates to the the scale-normalized gaussian, $\sigma^{2}\nabla^{2}G$. Lindeberg (1994)研究显示：scale-normalized Laplacian of Gaussian, $\sigma^{2}\nabla^{2}G$,具有尺度不变性，and the maximum and minimum of the $\sigma^{2}\nabla^{2}G$ can produce the most stable image features compared to a range of other possible image funcitons, such as gradient, Hessian, or Harris corner function.<br />
The relationship between $D$ and $\sigma\nabla^{2}G$:</p>

<script type="math/tex; mode=display">\frac{\partial G}{\partial \sigma} = \sigma \nabla^{2}G</script>

<p>而: $\sigma \nabla^{2}G = \frac{\partial G}{\partial \sigma}\approx \frac{G(x,y,k\sigma)-G(x,y,\sigma)}{k\sigma - \sigma}$</p>

<p>因此: $G(x,y,k\sigma)-G(x,y,\sigma) \approx (k-1)\sigma^{2}\nabla^{2}G$</p>

<p>可见: difference-of-gaussian function 与 scale-normalized gaussian function 相差一个$\sigma^{2}$的尺度因子，而（k-1）是个常数，不影响极值点的位置。</p>

<ol>
  <li>local extrema detection
<strong>how to locate local extrema（including local maxima and  minima）?</strong></li>
</ol>

<p>Each sample point is compared to its eight neighbors in the current image and nine neighbors in the sccale above and below.</p>

<p><img src="http://static.zybuluo.com/GwanSiu/dpifzu907hxhj0thznbg3mvv/image_1bh8un05u16931pklgkl16blho4m.png" alt="image_1bh8un05u16931pklgkl16blho4m.png-18.5kB" /></p>

<h3 id="22-keypoint-localization">2.2 Keypoint localization</h3>
<h4 id="221-accurate-keypoint-localization">2.2.1 Accurate keypoint localization</h4>
<p>根据选出的candidate keypoints,使用模型进一步准确拟合出Keypoints的位置（即计算出Keypoints的偏移量），在[link]: http://blog.csdn.net/zddblog/article/details/7521424 “zddhub”的博客中提到：图片是离散空间，而离散空间中的极值点并不是真正的极值点，从离散空间中寻找连续空间中极值点的是连续插值直至收敛。</p>

<p><img src="http://static.zybuluo.com/GwanSiu/x0fzdgysh55ncdwz14ydct05/image_1bh8vbp5u2ib6k3e8v34tq9d13.png" alt="image_1bh8vbp5u2ib6k3e8v34tq9d13.png-37.3kB" /></p>

<p>文中采用的是Brown and Lowe,2002提出的泰勒二阶拟合的方法：</p>

<script type="math/tex; mode=display">D(x) = D + \frac{\partial D^{T}}{\partial x} + \frac{1}{2} x^{T} \frac{\partial^{2} D}{\partial x^{2}}x</script>

<p>令$D(x)$的导数为零可以求得sample point $x=(x,y,\sigma)^{T}$的偏移量：</p>

<script type="math/tex; mode=display">\vec x = -\frac{\partial^{2} D}{\partial x^{2}}^{-1}\frac{\partial D}{\partial x}</script>

<p>进一步求得keypoints的准确位置：
<script type="math/tex">D(\hat{x}) = D + \frac{1}{2}\frac{\partial D}{\partial x} \vec x</script></p>

<p><strong>Why is the function value at the extremumm, $D(\hat{x})$ useful for rejecting unstable extrema with low constrast.</strong>
未填</p>

<p>####2.2.2 Eliminating edge responses</p>

<p>what’s the stability for the keypoint?
<strong>文中指出：for stability, it is not sufficient to reject keypoints with low constrast,The difference-of- Gaussian function will have a strong response along edges, even if the location along the edge is poorly determined and therefore unstable to small amounts of noise.</strong></p>

<p>并且 <strong>A poorly defined peak in the difference-of-Gaussian function will have a large principal curvature(曲率) across the edge but a small one in the perpendicular direction.</strong></p>

<p>The priciple curvatures can be computed by the a $2x2$ Hessian matrix, $H$, is computed at the location and sccale of the keypoint:</p>

<script type="math/tex; mode=display">% <![CDATA[
H=\left[
\begin{array}
 DD_{xx} & D_{xy} \\  
 D_{xy} & D_{yy} \\ 
\end{array}  
\right] %]]></script>

<p><strong>文中指出：The eigenvalues of $H$ are proportional to the principal curvatures of $D$.</strong>  但文中并不直接计算Hessian matrix $H$ 的特征值，而是通过计算最大特征值$\alpha$和次大特征值$\beta$的比值:</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
Tr(H) &= D_{xx} + D_{yy} = \alpha + \beta \\
Det(D) &= D_{xx}D_{yy} - (D_{xy})^{2} = \alpha \beta
\end{aligned} %]]></script>

<p>虽然某一点的曲率可以取正负，但经过local extrema步骤筛选之后，not extrema is filtered, 因此$Det(H)$ 不太可能取负值。The ratio between the largest magnitude eigenvalue and the smaller one, let‘s $\alpha=r \beta$:</p>

<script type="math/tex; mode=display">\frac{Tr(H)^{2}}{Det(H)} = \frac{(\alpha+\beta)^2}{\alpha\beta}=\frac{(r\beta+\beta)^{2}}{r\beta^{2}}=\frac{(r+1)^2}{r}</script>

<p>which depends only on the ratio of the eigenvalues rather than their individual values. The quantity $(r + 1)^{2}/r$ is at a minimum when the two eigenvalues are equal and it increases with r. Therefore, to check that the ratio of principal curvatures is below some threshold, r, we only need to check</p>

<script type="math/tex; mode=display">% <![CDATA[
\frac{Tr(H)^{2}}{Det(H)} < \frac{(r+1)^2}{r} %]]></script>

<p>通过直接计算最大特征值$\alpha$和次大特征值$\beta$的比值，使得运算非常快捷。下图展示了r=10消除principal curvatures大于10的,效果图（c）–&gt;(d)：</p>

<p><img src="http://static.zybuluo.com/GwanSiu/wunk18g93vmoaefk3bn5bgdq/image_1bh92s2sdh01hdf4hl11p8jl09.png" alt="image_1bh92s2sdh01hdf4hl11p8jl09.png-229.3kB" /></p>

<h3 id="23-orientation-assignment">2.3 Orientation assignment</h3>
<p>给每个特征点赋予方向信息：<strong>利用关键点邻域像素的梯度方向分布特性为每个关键点指定方向参数，使算子具备旋转不变性[2]。</strong></p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
m(x,y) &= \sqrt{(L(x+1,y)-L(x-1,y))^{2}+(L(x,y+1)-L(x,y-1))^2} \\
\theta (x,y) &= \tan^{-1}((L(x,y+1)-L(x,y-1)))/((L(x+1,y)-L(x-1,y)))\\
\end{aligned} %]]></script>

<p>For each image, $L(x,y)$ at this scale, the gradient magnitude, m(x,y), and orientation, $\theta$.</p>

<h3 id="24-descriptor-representation梯度方向直方图128维向量">2.4 Descriptor representation（梯度方向直方图，128维向量）</h3>
<p>梯度方向直方图的范围是：0~360度，通常每十度为一个bin, 一共36个bin.也可以每45度为一bin,一共8bin。
随着距中心点越远的领域其对直方图的贡献也响应减小.Lowe论文中还提到要使用高斯函数对直方图进行平滑，减少突变的影响[2]。直方图的峰值代表着该处领域的主方向，其他bin中超过峰值80%的可以作为辅助方向。以下图为例：
<img src="http://static.zybuluo.com/GwanSiu/gams8f450qse4arlio8ggii5/image_1bh94cvdr1bgk1j2r9rc1c501tg5l.png" alt="image_1bh94cvdr1bgk1j2r9rc1c501tg5l.png-92.4kB" /></p>

<p><img src="http://static.zybuluo.com/GwanSiu/4xywl7hn6igxye8rcb71hu6g/image_1bh94ql0n1ko512052hk1fu38615.png" alt="image_1bh94ql0n1ko512052hk1fu38615.png-57.4kB" /></p>

<p>考虑keypoint为8x8的邻域，将其领域分成2x2的的区域（descriptor），每一个区域为4x4的subimage,在每一个subimage中做梯度方向直方图，每45度为一bin,一共8bin. 那么这个SIFT特征维度为：2x2x8=32. 文中实验考虑的是16x16的邻域，4x4的descriptor,8 bins,因此SIFT特征的维度为：4x4x8 = 128.</p>

<p><strong>最后一步则是将SIFT特征归一化，进一步消除光照的影响</strong></p>



                <hr style="visibility: hidden;">

                


                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2017/05/20/network-in-network/" data-toggle="tooltip" data-placement="top" title="Network in Network">
                        Previous<br>
                        <span>Network in Network</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2017/05/27/SPP/" data-toggle="tooltip" data-placement="top" title="Note--Spatial Pyramid Pooling in Deep Convolutional Networks for Visual Recognition">
                        Next<br>
                        <span>Note--Spatial Pyramid Pooling in Deep Convolutional Networks for Visual Recognition</span>
                        </a>
                    </li>
                    
                </ul>


                

                
                <!-- disqus 评论框 start -->
                <div class="comment">
                    <div id="disqus_thread" class="disqus-thread"></div>
                </div>
                <!-- disqus 评论框 end -->
                

                
            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#Machine Learning" title="Machine Learning" rel="6">
                                    Machine Learning
                                </a>
                            
        				
        			</div>
                </section>
                

                <!-- Friends Blog -->
                
            </div>
        </div>
    </div>
</article>








<!-- disqus 公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = "GwanSiu";
    var disqus_identifier = "/2017/05/27/SIFT";
    var disqus_url = "http://localhost:4000/2017/05/27/SIFT/";

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<!-- disqus 公共JS代码 end -->




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                    

                    <!-- add Weibo, Zhihu by Hux, add target = "_blank" to <a> by Hux -->
                    
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/Gwan-siu">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="http://weibo.com/u/6056969706">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    


                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/Gwan-Siu">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; GwanSiu Blog 2017
                    <br>
                    Theme by <a href="http://huangxuan.me">Hux</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=huxpro&repo=huxpro.github.io&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>

<!-- Service Worker -->

<script type="text/javascript">
    if(navigator.serviceWorker){
        // For security reasons, a service worker can only control the pages that are in the same directory level or below it. That's why we put sw.js at ROOT level.
        navigator.serviceWorker
            .register('/sw.js')
            .then((registration) => {console.log('Service Worker Registered. ', registration)})
            .catch((error) => {console.log('ServiceWorker registration failed: ', error)})
    }
</script>



<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/ 
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers   
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async('/js/jquery.tagcloud.js',function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->

<script>
    // dynamic User by Hux
    var _gaId = 'UA-49627206-1';
    var _gaDomain = 'huangxuan.me';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>



<!-- Baidu Tongji -->




<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog (selector) {
        var P = $('div.post-container'),a,n,t,l,i,c;
        a = P.find('h1,h2,h3,h4,h5,h6');
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#"+$(this).prop('id');
            t = $(this).text();
            c = $('<a href="'+i+'" rel="nofollow">'+t+'</a>');
            l = $('<li class="'+n+'_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;    
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function(e){
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>





<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
